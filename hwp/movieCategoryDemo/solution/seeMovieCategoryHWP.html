<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
<script>

let categoryList=[{"idCategory":"1","category":"Com√©die","validCategory":"1"},{"idCategory":"2","category":"Fantastique","validCategory":"1"},{"idCategory":"3","category":"Thriller","validCategory":"1"},{"idCategory":"4","category":"Drame","validCategory":"1"},{"idCategory":"5","category":"Historique","validCategory":"1"}];

let movieList=[];
let dataString=localStorage.getItem('movieList');
if(dataString!=null) movieList=JSON.parse(dataString);

document.onreadystatechange=function(){
if(document.readyState=="complete"){
displayMovieList();	
}
}//fin onreadystatechange


function displayMovieList(){
let idMovieSum=0;

let codeHTML="<table><thead><tr><th>Title</th><th>Category</th></tr></thead><tbody>";

movieList.forEach(function(item,index){
idMovieSum+=parseInt(item.idMovie);

let searchIdCategory=item.idCategory;
let foundCategory=categoryList.find( categoryElement => categoryElement.idCategory==searchIdCategory).category;

codeHTML+=`<tr><td>${item.titleMovie}</td><td>${foundCategory}</td></tr>`;
});

codeHTML+="</tbody></table>";

document.getElementById('main').insertAdjacentHTML('afterbegin',codeHTML);

document.getElementById('main').insertAdjacentHTML('beforeend',"Total "+idMovieSum);

}//end fct

</script>
<style>
table {table-layout: auto;width: 600px;border:1px solid black;border-collapse: collapse;}	
th, td {border:1px solid black;}
</style>
</head>
<body>
<nav>
	<a href="movieCategoryHWP.html">[ New movie ]</a>
	<a href="javascript:localStorage.removeItem('movieList');">[ Delete All ]</a>
</nav>
<h1>List of movies</h1>
<section id="main"></section>	
</body>
</html>